
;eraIM@Sから流用（eramaou）

;=================================================
;アイテム購入・売却処理画面 
;=================================================
@ITEM_SHOP_TRAP
#DIM ICOUNT_A
#DIM ICOUNT_B
DRAWLINE
PRINTL 《던전에 거는 함정을 구입할 수 있습니다》
DRAWLINE
PRINTV DAY+1
PRINT 일째 
IF TIME == 0
	PRINTL  오전
ELSE
	PRINTL  오후
ENDIF

PRINTFORML [소지금:{MONEY}ポイント]

SETCOLORBYNAME LightSalmon
PRINTFORML [함정Lv:{FLAG:85}]
PRINTFORML [함정]
RESETCOLOR
ICOUNT_B = 0
FOR ICOUNT_A,60,92
	SIF ITEM:ICOUNT_A == 0
		CONTINUE
	PRINTFORM [%ITEMNAME:ICOUNT_A + @"(x{ITEM:ICOUNT_A})",18,LEFT%]
	ICOUNT_B += 1
	IF ICOUNT_B % 5 == 0
		PRINTL 
	ENDIF
NEXT
SIF ICOUNT_B % 5 > 0
	PRINTL 
SETCOLORBYNAME LightSalmon
PRINTFORML [반지]
RESETCOLOR
ICOUNT_B = 0
FOR ICOUNT_A,300,321
	SIF ITEM:ICOUNT_A == 0
		CONTINUE
	PRINTFORM [%ITEMNAME:ICOUNT_A + @"(x{ITEM:ICOUNT_A})",18,LEFT%]
	ICOUNT_B += 1
	IF ICOUNT_B % 5 == 0
		PRINTL 
	ENDIF
NEXT
SIF ICOUNT_B % 5 > 0
	PRINTL 

DRAWLINE

CALL SALEITEM_CHECK_TRAP
;소지 포인트를 임시 저장
TFLAG:15 = MONEY

$INPUT_LOOP
;以下に自動的に売り物が表示される
PRINT_SHOPITEM

PRINTL 《구입하는 함정의 번호를 입력해 주세요》

DRAWLINE
PRINT [997] - 통상 아이템　
PRINTL [999] - 돌아온다


;-------------------------------------------------
;함정 출현 조건
;-------------------------------------------------
@SALEITEM_CHECK_TRAP

ITEMSALES:60 = 1
ITEMSALES:61 = 1
ITEMSALES:62 = 1
ITEMSALES:63 = 1
ITEMSALES:69 = 1
ITEMSALES:72 = 1
ITEMSALES:73 = 1
ITEMSALES:74 = 1
ITEMSALES:75 = 1
ITEMSALES:76 = 1
ITEMSALES:77 = 1
ITEMSALES:78 = 1
ITEMSALES:81 = 1
ITEMSALES:82 = 1
ITEMSALES:83 = 1
ITEMSALES:84 = 1
ITEMSALES:85 = 1

IF TALENT:0:327 == 1
	;야한 함정
	ITEMSALES:64 = 1
	ITEMSALES:65 = 1
	ITEMSALES:66 = 1
	ITEMSALES:67 = 1
	ITEMSALES:68 = 1
	ITEMSALES:70 = 1
	ITEMSALES:71 = 1
	ITEMSALES:79 = 1
ELSE
	;음마지식
	ITEMSALES:54 = 1
ENDIF

;마충지식
SIF TALENT:MASTER:328 == 0
	ITEMSALES:56 = 1

;魔蟲知識でも手に入る罠
IF TALENT:MASTER:328 == 1
	ITEMSALES:65 = 1
	ITEMSALES:79 = 1
	ITEMSALES:80 = 1
ENDIF

;반지
ITEMSALES:91 = 1
;함정Lv
SIF FLAG:85 < CFLAG:0:9
	ITEMSALES:55 = 1

RETURN 0


;
;